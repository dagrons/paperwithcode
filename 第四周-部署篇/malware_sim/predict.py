# %%
from gensim.models.doc2vec import Doc2Vec
from scripts.transform import get_opcode_from
import os

# %%
model_path = "/root/paperwithcode/第三周-训练篇/malware_sim/trained_models/malware_sim%doc2vec.pth"
model = Doc2Vec.load(model_path)

# %%
def predict(bytes_path):
    ops = get_opcode_from(bytes_path)
    return model.infer_vector(ops)

